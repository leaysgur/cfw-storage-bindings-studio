var m=Object.defineProperty;var r=(e,n)=>m(e,"name",{value:n,configurable:!0});import{n as l,s as q,p as x,r as z,v as A}from"./scheduler.8c8bb1bf.js";const f=[];function v(e,n){return{subscribe:B(e,n).subscribe}}r(v,"readable");function B(e,n=l){let i;const o=new Set;function c(t){if(q(e,t)&&(e=t,i)){const u=!f.length;for(const s of o)s[1](),f.push(s,e);if(u){for(let s=0;s<f.length;s+=2)f[s][0](f[s+1]);f.length=0}}}r(c,"set");function b(t){c(t(e))}r(b,"update");function p(t,u=l){const s=[t,u];return o.add(s),o.size===1&&(i=n(c,b)||l),t(e),()=>{o.delete(s),o.size===0&&i&&(i(),i=null)}}return r(p,"subscribe"),{set:c,update:b,subscribe:p}}r(B,"writable");function j(e,n,i){const o=!Array.isArray(e),c=o?[e]:e;if(!c.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const b=n.length<2;return v(i,(p,t)=>{let u=!1;const s=[];let d=0,g=l;const y=r(()=>{if(d)return;g();const a=n(o?s[0]:s,p,t);b?p(a):g=A(a)?a:l},"sync"),_=c.map((a,h)=>x(a,w=>{s[h]=w,d&=~(1<<h),u&&y()},()=>{d|=1<<h}));return u=!0,y(),r(function(){z(_),g(),u=!1},"stop")})}r(j,"derived");export{j as d,v as r,B as w};
