var Ne=Object.defineProperty;var is=(r,t,e)=>t in r?Ne(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var u=(r,t)=>Ne(r,"name",{value:t,configurable:!0});var E=(r,t,e)=>(is(r,typeof t!="symbol"?t+"":t,e),e),ae=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var i=(r,t,e)=>(ae(r,t,"read from private field"),e?e.call(r):t.get(r)),d=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},l=(r,t,e,s)=>(ae(r,t,"write to private field"),s?s.call(r,e):t.set(r,e),e);var Xt=(r,t,e,s)=>({set _(n){l(r,t,n,e)},get _(){return i(r,t,s)}}),y=(r,t,e)=>(ae(r,t,"access private method"),e);import{i as cs,g as os,c as Ht,f as us,s as He,d as Le,u as ze,e as Je,h as We,o as Ye,j as hs,k as ls,n as wt}from"../chunks/scheduler.8c8bb1bf.js";import{p as ds,t as Tt,b as fs,d as Kt,S as Ze,i as ts,e as Ae,a as K,f as B,g as Dt,m as H,h as Et,j as zt,n as L,x as P,o as oe,s as ue,r as ps,c as he,u as ys,v as ms,y as bs,w as ws,k as ke}from"../chunks/index.934348cb.js";import{r as gs,n as R,t as Ds,c as Es,a as _,i as re,b as Is,S as es,h as ss,m as Ce,d as Ue,f as qe,o as Fe,e as vs,g as Qe,p as Pe,s as _s,j as Ge}from"../chunks/context.f1412b6d.js";import{U as ns,N as js,P as Ms,a as Os,b as as,H as Bs,p as xe}from"../chunks/parse.457da179.js";import{R as Ss,M as Rs,i as Ns}from"../chunks/infiniteQueryBehavior.e2cd4775.js";function $e(r,t){const e=t.token={};function s(n,a,o,f){if(t.token!==e)return;t.resolved=f;let p=t.ctx;o!==void 0&&(p=p.slice(),p[o]=f);const c=n&&(t.current=n)(p);let b=!1;t.block&&(t.blocks?t.blocks.forEach((h,m)=>{m!==a&&h&&(ds(),Tt(h,1,1,()=>{t.blocks[m]===h&&(t.blocks[m]=null)}),fs())}):t.block.d(1),c.c(),Kt(c,1),c.m(t.mount(),t.anchor),b=!0),t.block=c,t.blocks&&(t.blocks[a]=c),b&&us()}if(u(s,"update"),cs(r)){const n=os();if(r.then(a=>{Ht(n),s(t.then,1,t.value,a),Ht(null)},a=>{if(Ht(n),s(t.catch,2,t.error,a),Ht(null),!t.hasCatch)throw a}),t.current!==t.pending)return s(t.pending,0),!0}else{if(t.current!==t.then)return s(t.then,1,t.value,r),!0;t.resolved=r}}u($e,"handle_promise");function As(r,t,e){const s=t.slice(),{resolved:n}=r;r.current===r.then&&(s[r.value]=n),r.current===r.catch&&(s[r.error]=n),r.block.p(s,e)}u(As,"update_await_block_branch");const be=class be extends Error{constructor(t,e){super(t),this.name="DevalueError",this.path=e.join("")}};u(be,"DevalueError");let gt=be;function Te(r){return Object(r)!==r}u(Te,"is_primitive");const ks=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Cs(r){const t=Object.getPrototypeOf(r);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===ks}u(Cs,"is_plain_object");function Us(r){return Object.prototype.toString.call(r).slice(8,-1)}u(Us,"get_type");function qs(r){switch(r){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return r<" "?`\\u${r.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}u(qs,"get_escaped_char");function st(r){let t="",e=0;const s=r.length;for(let n=0;n<s;n+=1){const a=r[n],o=qs(a);o&&(t+=r.slice(e,n)+o,e=n+1)}return`"${e===0?r:t+r.slice(e)}"`}u(st,"stringify_string");function Vt(r,t){const e=[],s=new Map,n=[];for(const c in t)n.push({key:c,fn:t[c]});const a=[];let o=0;function f(c){if(typeof c=="function")throw new gt("Cannot stringify a function",a);if(s.has(c))return s.get(c);if(c===void 0)return ns;if(Number.isNaN(c))return js;if(c===1/0)return Ms;if(c===-1/0)return Os;if(c===0&&1/c<0)return as;const b=o++;s.set(c,b);for(const{key:m,fn:v}of n){const g=v(c);if(g)return e[b]=`["${m}",${f(g)}]`,b}let h="";if(Te(c))h=ie(c);else switch(Us(c)){case"Number":case"String":case"Boolean":h=`["Object",${ie(c)}]`;break;case"BigInt":h=`["BigInt",${c}]`;break;case"Date":h=`["Date","${c.toISOString()}"]`;break;case"RegExp":const{source:v,flags:g}=c;h=g?`["RegExp",${st(v)},"${g}"]`:`["RegExp",${st(v)}]`;break;case"Array":h="[";for(let w=0;w<c.length;w+=1)w>0&&(h+=","),w in c?(a.push(`[${w}]`),h+=f(c[w]),a.pop()):h+=Bs;h+="]";break;case"Set":h='["Set"';for(const w of c)h+=`,${f(w)}`;h+="]";break;case"Map":h='["Map"';for(const[w,S]of c)a.push(`.get(${Te(w)?ie(w):"..."})`),h+=`,${f(w)},${f(S)}`;h+="]";break;default:if(!Cs(c))throw new gt("Cannot stringify arbitrary non-POJOs",a);if(Object.getOwnPropertySymbols(c).length>0)throw new gt("Cannot stringify POJOs with symbolic keys",a);if(Object.getPrototypeOf(c)===null){h='["null"';for(const w in c)a.push(`.${w}`),h+=`,${st(w)},${f(c[w])}`,a.pop();h+="]"}else{h="{";let w=!1;for(const S in c)w&&(h+=","),w=!0,a.push(`.${S}`),h+=`${st(S)}:${f(c[S])}`,a.pop();h+="}"}}return e[b]=h,b}u(f,"flatten");const p=f(r);return p<0?`${p}`:`[${e.join(",")}]`}u(Vt,"stringify");function ie(r){const t=typeof r;return t==="string"?st(r):r instanceof String?st(r.toString()):r===void 0?ns.toString():r===0&&1/r<0?as.toString():t==="bigint"?`["BigInt","${r}"]`:String(r)}u(ie,"stringify_primitive");const ce=u(r=>encodeURIComponent(r),"encodeKey$1");var It,vt,z,yt;const we=class we{constructor(t,e){d(this,z);d(this,It,void 0);d(this,vt,void 0);l(this,It,t),l(this,vt,e)}async list(t){return await(await y(this,z,yt).call(this,"KVNamespace.list",[t])).json()}async put(t,e,s){await y(this,z,yt).call(this,"KVNamespace.put",[ce(t),s],e)}async get(t,e){const{value:s}=await this.getWithMetadata(t,e);return s}async getWithMetadata(t,e){const s=await y(this,z,yt).call(this,"KVNamespace.getWithMetadata",[ce(t),e]);if(s.headers.get("X-BRIDGE-KV-ValueIsNull")==="true")return{value:null,metadata:null,cacheStatus:null};let n;typeof(e==null?void 0:e.type)=="string"?n=e.type:typeof e=="string"?n=e:n="text";let a;n==="json"&&(a=await s.json()),n==="text"&&(a=await s.text()),n==="arrayBuffer"&&(a=await s.arrayBuffer()),n==="stream"&&(a=s.body);const o=xe(s.headers.get("X-BRIDGE-KV-Metadata")??"[null]"),f=xe(s.headers.get("X-BRIDGE-KV-CacheStatus")??"[null]");return{value:a,metadata:o,cacheStatus:f}}async delete(t){await y(this,z,yt).call(this,"KVNamespace.delete",[ce(t)])}};It=new WeakMap,vt=new WeakMap,z=new WeakSet,yt=u(async function(t,e,s){const n=await fetch(i(this,It),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"KV","X-BRIDGE-BINDING-NAME":i(this,vt),"X-BRIDGE-KV-Dispatch":Vt({operation:t,parameters:e})},body:s,duplex:"half"});if(!n.ok){const a=await n.text();throw new Error(a)}return n},"#dispatch"),u(we,"KVNamespace$");let Jt=we;var _t,jt;const ge=class ge{constructor(t,e){d(this,_t,void 0);d(this,jt,void 0);l(this,_t,t),l(this,jt,e)}async fetch(t,e){const s=new Request(t,e),n=new Request(i(this,_t),s);return n.headers.set("X-BRIDGE-BINDING-MODULE","SERVICE"),n.headers.set("X-BRIDGE-BINDING-NAME",i(this,jt)),n.headers.set("X-BRIDGE-SERVICE-Dispatch",JSON.stringify({operation:"Fetcher.fetch",parameters:[s.url]})),fetch(n)}};_t=new WeakMap,jt=new WeakMap,u(ge,"Fetcher$");let Wt=ge;var Mt;const De=class De{constructor(t){d(this,Mt,void 0);l(this,Mt,t)}async fetch(t,e){const s=new Request(t,e),n=new URL(s.url),a=new URL(i(this,Mt));return n.protocol=a.protocol,n.host=a.host,fetch(n,s)}};Mt=new WeakMap,u(De,"DirectFetcher$");let le=De;const pt=u(r=>{const t=new Uint8Array(r.length/2);for(let e=0;e<r.length;e+=2)t[e/2]=parseInt(r.substring(e,e+2),16);return t.buffer},"hexStringToArrayBuffer"),Fs=u(r=>{const t=new Uint8Array(r);let e="";for(let s=0;s<t.length;s++){const n=t[s].toString(16);e+=n.length===1?"0"+n:n}return e},"arrayBufferToHexString"),F=u(r=>encodeURIComponent(r),"encodeKey");var Ot;const Ee=class Ee{constructor(t){d(this,Ot,void 0);E(this,"md5");E(this,"sha1");E(this,"sha256");E(this,"sha384");E(this,"sha512");l(this,Ot,t),this.md5=t.md5?pt(t.md5):void 0,this.sha1=t.sha1?pt(t.sha1):void 0,this.sha256=t.sha256?pt(t.sha256):void 0,this.sha384=t.sha384?pt(t.sha384):void 0,this.sha512=t.sha512?pt(t.sha512):void 0,Object.freeze(this)}toJSON(){return i(this,Ot)}};Ot=new WeakMap,u(Ee,"Checksums$");let de=Ee;const Ie=class Ie{constructor(t){E(this,"key");E(this,"version");E(this,"size");E(this,"etag");E(this,"httpEtag");E(this,"checksums");E(this,"uploaded");E(this,"httpMetadata");E(this,"customMetadata");E(this,"range");this.key=t.key,this.version=t.version,this.size=t.size,this.etag=t.etag,this.httpEtag=t.httpEtag,this.checksums=new de(t.checksums),this.uploaded=new Date(t.uploaded),this.httpMetadata={...t.httpMetadata,cacheExpiry:t.httpMetadata.cacheExpiry?new Date(t.httpMetadata.cacheExpiry):void 0},t.httpMetadata.cacheExpiry||delete this.httpMetadata.cacheExpiry,this.customMetadata=t.customMetadata,this.range=t.range,Object.freeze(this)}writeHttpMetadata(t){var e,s,n,a,o,f;(e=this.httpMetadata)!=null&&e.contentType&&t.set("content-type",this.httpMetadata.contentType),(s=this.httpMetadata)!=null&&s.contentLanguage&&t.set("content-language",this.httpMetadata.contentLanguage),(n=this.httpMetadata)!=null&&n.contentDisposition&&t.set("content-disposition",this.httpMetadata.contentDisposition),(a=this.httpMetadata)!=null&&a.contentEncoding&&t.set("content-encoding",this.httpMetadata.contentEncoding),(o=this.httpMetadata)!=null&&o.cacheControl&&t.set("cache-control",this.httpMetadata.cacheControl),(f=this.httpMetadata)!=null&&f.cacheExpiry&&t.set("expires",this.httpMetadata.cacheExpiry.toUTCString())}};u(Ie,"HeadResult$");let V=Ie;var k;const ve=class ve extends V{constructor(e,s){super(e);d(this,k,void 0);l(this,k,s)}get body(){return i(this,k).body??new ReadableStream}get bodyUsed(){return i(this,k).bodyUsed}async arrayBuffer(){return i(this,k).arrayBuffer()}async text(){return i(this,k).text()}async json(){return i(this,k).json()}async blob(){return i(this,k).blob()}};k=new WeakMap,u(ve,"GetResult$");let fe=ve;var J;const _e=class _e{constructor({key:t,uploadId:e},s){d(this,J,void 0);E(this,"key");E(this,"uploadId");l(this,J,s),this.key=t,this.uploadId=e,Object.freeze(this)}async uploadPart(t,e){return await(await i(this,J).call(this,"R2MultipartUpload.uploadPart",[F(this.key),this.uploadId,t],e)).json()}async abort(){await i(this,J).call(this,"R2MultipartUpload.abort",[F(this.key),this.uploadId])}async complete(t){const s=await(await i(this,J).call(this,"R2MultipartUpload.complete",[F(this.key),this.uploadId,t])).json();return new V(s)}};J=new WeakMap,u(_e,"R2MultipartUpload$");let Yt=_e;var Bt,St,N,U;const je=class je{constructor(t,e){d(this,N);d(this,Bt,void 0);d(this,St,void 0);l(this,Bt,t),l(this,St,e)}async list(t){const s=await(await y(this,N,U).call(this,"R2Bucket.list",[t])).json();return{...s,objects:s.objects.map(n=>new V(n))}}async put(t,e,s){const a=await(await y(this,N,U).call(this,"R2Bucket.put",[F(t),null,s],e??void 0)).json();return a===null?null:new V(a)}async get(t,e){const s=await y(this,N,U).call(this,"R2Bucket.get",[F(t),e]),n=s.headers.get("X-BRIDGE-R2-R2ObjectJSON");if(n){const o=JSON.parse(n);return new fe(o,s)}const a=await s.json();return a===null?null:new V(a)}async head(t){const s=await(await y(this,N,U).call(this,"R2Bucket.head",[F(t)])).json();return s===null?null:new V(s)}async delete(t){t=typeof t=="string"?F(t):t.map(e=>F(e)),await y(this,N,U).call(this,"R2Bucket.delete",[t])}async createMultipartUpload(t,e){const n=await(await y(this,N,U).call(this,"R2Bucket.createMultipartUpload",[F(t),e])).json();return new Yt(n,y(this,N,U).bind(this))}resumeMultipartUpload(t,e){return new Yt({key:t,uploadId:e},y(this,N,U).bind(this))}};Bt=new WeakMap,St=new WeakMap,N=new WeakSet,U=u(async function(t,e,s){const n=await fetch(i(this,Bt),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"R2","X-BRIDGE-BINDING-NAME":i(this,St),"X-BRIDGE-R2-Dispatch":Vt({operation:t,parameters:e},{Headers:a=>a instanceof Headers&&Array.from(a),ArrayBuffer:a=>a instanceof ArrayBuffer&&Fs(a)})},body:s,duplex:"half"});if(!n.ok){const a=await n.text();throw new Error(a)}return n},"#dispatch"),u(je,"R2Bucket$");let Zt=je;const Qs=u(r=>r.map(t=>t instanceof ArrayBuffer?Array.from(new Uint8Array(t)):ArrayBuffer.isView(t)?Array.from(t):t),"encodeBindValues");var W,nt,at,Y,mt;const ne=class ne{constructor(t,e,s){d(this,Y);d(this,W,void 0);d(this,nt,void 0);d(this,at,void 0);l(this,W,t),l(this,nt,e),l(this,at,s)}get statement(){return i(this,W)}get params(){return i(this,nt)}bind(...t){return new ne(i(this,W),Qs(t),i(this,at))}async first(t){return y(this,Y,mt).call(this,"D1PreparedStatement.first",t)}async run(){return y(this,Y,mt).call(this,"D1PreparedStatement.run")}async all(){return y(this,Y,mt).call(this,"D1PreparedStatement.all")}async raw(){return y(this,Y,mt).call(this,"D1PreparedStatement.raw")}};W=new WeakMap,nt=new WeakMap,at=new WeakMap,Y=new WeakSet,mt=u(async function(t,e){return await(await i(this,at).call(this,t,[i(this,W),i(this,nt),e])).json()},"#send"),u(ne,"D1PreparedStatement$");let pe=ne;var Rt,Nt,Z,bt;const Me=class Me{constructor(t,e){d(this,Z);d(this,Rt,void 0);d(this,Nt,void 0);l(this,Rt,t),l(this,Nt,e)}prepare(t){return new pe(t,[],y(this,Z,bt).bind(this))}async dump(){return await(await y(this,Z,bt).call(this,"D1Database.dump",[])).arrayBuffer()}async batch(t){return await(await y(this,Z,bt).call(this,"D1Database.batch",[t.map(n=>{const a=n;return[a.statement,a.params]})])).json()}async exec(t){return await(await y(this,Z,bt).call(this,"D1Database.exec",[t])).json()}};Rt=new WeakMap,Nt=new WeakMap,Z=new WeakSet,bt=u(async function(t,e){const s=await fetch(i(this,Rt),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"D1","X-BRIDGE-BINDING-NAME":i(this,Nt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Me,"D1Database$");let te=Me;var At,kt,Ct,ye;const Oe=class Oe{constructor(t,e){d(this,Ct);d(this,At,void 0);d(this,kt,void 0);l(this,At,t),l(this,kt,e)}async send(t,e){await y(this,Ct,ye).call(this,"Queue.send",[t,e])}async sendBatch(t){await y(this,Ct,ye).call(this,"Queue.sendBatch",[t])}};At=new WeakMap,kt=new WeakMap,Ct=new WeakSet,ye=u(async function(t,e){const s=await fetch(i(this,At),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"QUEUE","X-BRIDGE-BINDING-NAME":i(this,kt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Oe,"WorkerQueue$");let ee=Oe;var Ut,qt,Q,X;const Be=class Be{constructor(t,e){d(this,Q);d(this,Ut,void 0);d(this,qt,void 0);l(this,Ut,t),l(this,qt,e)}async describe(){return await(await y(this,Q,X).call(this,"VectorizeIndex.describe",[])).json()}async query(t,e){return await(await y(this,Q,X).call(this,"VectorizeIndex.query",[t,e])).json()}async insert(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.insert",[t])).json()}async upsert(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.upsert",[t])).json()}async deleteByIds(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.deleteByIds",[t])).json()}async getByIds(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.getByIds",[t])).json()}};Ut=new WeakMap,qt=new WeakMap,Q=new WeakSet,X=u(async function(t,e){const s=await fetch(i(this,Ut),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"VECTORIZE","X-BRIDGE-BINDING-NAME":i(this,qt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Be,"VectorizeIndex$");let se=Be;const Ps=u(async r=>{const t=new URL("/_internals/getBindings",r),s=await(await fetch(t,{headers:{"content-type":"application/json"}})).json(),n={};for(const[a,o]of Object.entries(s))o==="d1"&&(n[a]=new te(r,a)),o==="kv"&&(n[a]=new Jt(r,a)),o==="queue"&&(n[a]=new ee(r,a)),o==="r2"&&(n[a]=new Zt(r,a)),o==="service"&&(n[a]=new Wt(r,a)),o==="vectorize"&&(n[a]=new se(r,a));return n},"getBindings"),Gs=u((r="http://127.0.0.1:8787")=>({getBindings:()=>Ps(r),KVNamespace:t=>new Jt(r,t),Fetcher:(t,e)=>e?new le(e):new Wt(r,t),R2Bucket:t=>new Zt(r,t),D1Database:t=>new te(r,t),Queue:t=>new ee(r,t),VectorizeIndex:t=>new se(r,t)}),"createBridge");var rt,it,j,G,M,I,Ft,tt,ct,Lt,A,q,Qt,xs=(Qt=class extends Ss{constructor(e){super();d(this,ct);d(this,A);d(this,rt,void 0);d(this,it,void 0);d(this,j,void 0);d(this,G,void 0);d(this,M,void 0);d(this,I,void 0);d(this,Ft,void 0);d(this,tt,void 0);l(this,tt,!1),l(this,Ft,e.defaultOptions),y(this,ct,Lt).call(this,e.options),l(this,I,[]),l(this,j,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,l(this,rt,e.state||$s(this.options)),this.state=i(this,rt),this.scheduleGc()}get meta(){return this.options.meta}optionalRemove(){!i(this,I).length&&this.state.fetchStatus==="idle"&&i(this,j).remove(this)}setData(e,s){const n=gs(this.state.data,e,this.options);return y(this,A,q).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(e,s){y(this,A,q).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var n;const s=i(this,G);return(n=i(this,M))==null||n.cancel(e),s?s.then(R).catch(R):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(i(this,rt))}isActive(){return i(this,I).some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||i(this,I).some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Ds(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=i(this,I).find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,M))==null||s.continue()}onOnline(){var s;const e=i(this,I).find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,M))==null||s.continue()}addObserver(e){i(this,I).includes(e)||(i(this,I).push(e),this.clearGcTimeout(),i(this,j).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){i(this,I).includes(e)&&(l(this,I,i(this,I).filter(s=>s!==e)),i(this,I).length||(i(this,M)&&(i(this,tt)?i(this,M).cancel({revert:!0}):i(this,M).cancelRetry()),this.scheduleGc()),i(this,j).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return i(this,I).length}invalidate(){this.state.isInvalidated||y(this,A,q).call(this,{type:"invalidate"})}fetch(e,s){var b,h,m,v;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(i(this,G))return(b=i(this,M))==null||b.continueRetry(),i(this,G)}if(e&&y(this,ct,Lt).call(this,e),!this.options.queryFn){const g=i(this,I).find(w=>w.options.queryFn);g&&y(this,ct,Lt).call(this,g.options)}const n=new AbortController,a={queryKey:this.queryKey,meta:this.meta},o=u(g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(l(this,tt,!0),n.signal)})},"addSignalProperty");o(a);const f=u(()=>this.options.queryFn?(l(this,tt,!1),this.options.persister?this.options.persister(this.options.queryFn,a,this):this.options.queryFn(a)):Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)),"fetchFn"),p={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:f};o(p),(h=this.options.behavior)==null||h.onFetch(p,this),l(this,it,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=p.fetchOptions)==null?void 0:m.meta))&&y(this,A,q).call(this,{type:"fetch",meta:(v=p.fetchOptions)==null?void 0:v.meta});const c=u(g=>{var w,S,dt,ft;re(g)&&g.silent||y(this,A,q).call(this,{type:"error",error:g}),re(g)||((S=(w=i(this,j).config).onError)==null||S.call(w,g,this),(ft=(dt=i(this,j).config).onSettled)==null||ft.call(dt,this.state.data,g,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},"onError");return l(this,M,Es({fn:p.fetchFn,abort:n.abort.bind(n),onSuccess:g=>{var w,S,dt,ft;if(typeof g>"u"){c(new Error(`${this.queryHash} data is undefined`));return}this.setData(g),(S=(w=i(this,j).config).onSuccess)==null||S.call(w,g,this),(ft=(dt=i(this,j).config).onSettled)==null||ft.call(dt,g,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:c,onFail:(g,w)=>{y(this,A,q).call(this,{type:"failed",failureCount:g,error:w})},onPause:()=>{y(this,A,q).call(this,{type:"pause"})},onContinue:()=>{y(this,A,q).call(this,{type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay,networkMode:p.options.networkMode})),l(this,G,i(this,M).promise),i(this,G)}},rt=new WeakMap,it=new WeakMap,j=new WeakMap,G=new WeakMap,M=new WeakMap,I=new WeakMap,Ft=new WeakMap,tt=new WeakMap,ct=new WeakSet,Lt=u(function(e){this.options={...i(this,Ft),...e},this.updateGcTime(this.options.gcTime)},"#setOptions"),A=new WeakSet,q=u(function(e){const s=u(n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:e.meta??null,fetchStatus:Is(this.options.networkMode)?"fetching":"paused",...!n.dataUpdatedAt&&{error:null,status:"pending"}};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return re(a)&&a.revert&&i(this,it)?{...i(this,it),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}},"reducer");this.state=s(this.state),_.batch(()=>{i(this,I).forEach(n=>{n.onQueryUpdate()}),i(this,j).notify({query:this,type:"updated",action:e})})},"#dispatch"),u(Qt,"Query"),Qt);function $s(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=typeof t<"u",s=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}u($s,"getDefaultState");var C,Pt,Ts=(Pt=class extends es{constructor(e={}){super();d(this,C,void 0);this.config=e,l(this,C,new Map)}build(e,s,n){const a=s.queryKey,o=s.queryHash??ss(a,s);let f=this.get(o);return f||(f=new xs({cache:this,queryKey:a,queryHash:o,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(f)),f}add(e){i(this,C).has(e.queryHash)||(i(this,C).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=i(this,C).get(e.queryHash);s&&(e.destroy(),s===e&&i(this,C).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){_.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return i(this,C).get(e)}getAll(){return[...i(this,C).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>Ce(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>Ce(e,n)):s}notify(e){_.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){_.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){_.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},C=new WeakMap,u(Pt,"QueryCache"),Pt),O,Gt,et,xt,Ks=(xt=class extends es{constructor(e={}){super();d(this,O,void 0);d(this,Gt,void 0);d(this,et,void 0);this.config=e,l(this,O,[]),l(this,Gt,0)}build(e,s,n){const a=new Rs({mutationCache:this,mutationId:++Xt(this,Gt)._,options:e.defaultMutationOptions(s),state:n});return this.add(a),a}add(e){i(this,O).push(e),this.notify({type:"added",mutation:e})}remove(e){l(this,O,i(this,O).filter(s=>s!==e)),this.notify({type:"removed",mutation:e})}clear(){_.batch(()=>{i(this,O).forEach(e=>{this.remove(e)})})}getAll(){return i(this,O)}find(e){const s={exact:!0,...e};return i(this,O).find(n=>Ue(s,n))}findAll(e={}){return i(this,O).filter(s=>Ue(e,s))}notify(e){_.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){return l(this,et,(i(this,et)??Promise.resolve()).then(()=>{const e=i(this,O).filter(s=>s.state.isPaused);return _.batch(()=>e.reduce((s,n)=>s.then(()=>n.continue().catch(R)),Promise.resolve()))}).then(()=>{l(this,et,void 0)})),i(this,et)}},O=new WeakMap,Gt=new WeakMap,et=new WeakMap,u(xt,"MutationCache"),xt),D,x,$,ot,ut,T,ht,lt,$t,rs=($t=class{constructor(t={}){d(this,D,void 0);d(this,x,void 0);d(this,$,void 0);d(this,ot,void 0);d(this,ut,void 0);d(this,T,void 0);d(this,ht,void 0);d(this,lt,void 0);l(this,D,t.queryCache||new Ts),l(this,x,t.mutationCache||new Ks),l(this,$,t.defaultOptions||{}),l(this,ot,new Map),l(this,ut,new Map),l(this,T,0)}mount(){Xt(this,T)._++,i(this,T)===1&&(l(this,ht,qe.subscribe(()=>{qe.isFocused()&&(this.resumePausedMutations(),i(this,D).onFocus())})),l(this,lt,Fe.subscribe(()=>{Fe.isOnline()&&(this.resumePausedMutations(),i(this,D).onOnline())})))}unmount(){var t,e;Xt(this,T)._--,i(this,T)===0&&((t=i(this,ht))==null||t.call(this),l(this,ht,void 0),(e=i(this,lt))==null||e.call(this),l(this,lt,void 0))}isFetching(t){return i(this,D).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return i(this,x).findAll({...t,status:"pending"}).length}getQueryData(t){var e;return(e=i(this,D).find({queryKey:t}))==null?void 0:e.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);return e!==void 0?Promise.resolve(e):this.fetchQuery(t)}getQueriesData(t){return this.getQueryCache().findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=i(this,D).find({queryKey:t}),a=n==null?void 0:n.state.data,o=vs(e,a);if(typeof o>"u")return;const f=this.defaultQueryOptions({queryKey:t});return i(this,D).build(this,f).setData(o,{...s,manual:!0})}setQueriesData(t,e,s){return _.batch(()=>this.getQueryCache().findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){var e;return(e=i(this,D).find({queryKey:t}))==null?void 0:e.state}removeQueries(t){const e=i(this,D);_.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=i(this,D),n={type:"active",...t};return _.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(n,e)))}cancelQueries(t={},e={}){const s={revert:!0,...e},n=_.batch(()=>i(this,D).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(R).catch(R)}invalidateQueries(t={},e={}){return _.batch(()=>{if(i(this,D).findAll(t).forEach(n=>{n.invalidate()}),t.refetchType==="none")return Promise.resolve();const s={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(s,e)})}refetchQueries(t={},e){const s={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},n=_.batch(()=>i(this,D).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,s);return s.throwOnError||(o=o.catch(R)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(R)}fetchQuery(t){const e=this.defaultQueryOptions(t);typeof e.retry>"u"&&(e.retry=!1);const s=i(this,D).build(this,e);return s.isStaleByTime(e.staleTime)?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(R).catch(R)}fetchInfiniteQuery(t){return t.behavior=Ns(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(R).catch(R)}resumePausedMutations(){return i(this,x).resumePausedMutations()}getQueryCache(){return i(this,D)}getMutationCache(){return i(this,x)}getDefaultOptions(){return i(this,$)}setDefaultOptions(t){l(this,$,t)}setQueryDefaults(t,e){i(this,ot).set(Qe(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...i(this,ot).values()];let s={};return e.forEach(n=>{Pe(t,n.queryKey)&&(s={...s,...n.defaultOptions})}),s}setMutationDefaults(t,e){i(this,ut).set(Qe(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...i(this,ut).values()];let s={};return e.forEach(n=>{Pe(t,n.mutationKey)&&(s={...s,...n.defaultOptions})}),s}defaultQueryOptions(t){if(t!=null&&t._defaulted)return t;const e={...i(this,$).queries,...(t==null?void 0:t.queryKey)&&this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ss(e.queryKey,e)),typeof e.refetchOnReconnect>"u"&&(e.refetchOnReconnect=e.networkMode!=="always"),typeof e.throwOnError>"u"&&(e.throwOnError=!!e.suspense),typeof e.networkMode>"u"&&e.persister&&(e.networkMode="offlineFirst"),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...i(this,$).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){i(this,D).clear(),i(this,x).clear()}},D=new WeakMap,x=new WeakMap,$=new WeakMap,ot=new WeakMap,ut=new WeakMap,T=new WeakMap,ht=new WeakMap,lt=new WeakMap,u($t,"QueryClient"),$t);function Vs(r){let t;const e=r[2].default,s=Le(e,r,r[1],null);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,a){s&&s.m(n,a),t=!0},p(n,[a]){s&&s.p&&(!t||a&2)&&ze(s,e,n,n[1],t?We(e,n[1],a,null):Je(n[1]),null)},i(n){t||(Kt(s,n),t=!0)},o(n){Tt(s,n),t=!1},d(n){s&&s.d(n)}}}u(Vs,"create_fragment$1");function Xs(r,t,e){let{$$slots:s={},$$scope:n}=t,{client:a=new rs}=t;return Ye(()=>{a.mount()}),_s(a),hs(()=>{a.unmount()}),r.$$set=o=>{"client"in o&&e(0,a=o.client),"$$scope"in o&&e(1,n=o.$$scope)},[a,n,s]}u(Xs,"instance$1");const Se=class Se extends Ze{constructor(t){super(),ts(this,t,Xs,Vs,He,{client:0})}};u(Se,"QueryClientProvider");let me=Se;function Ke(r,t,e){const s=r.slice();s[6]=t[e][0],s[7]=t[e][1];const n=s[2](s[7].constructor.name);return s[8]=n,s}u(Ke,"get_each_context");function Hs(r){let t,e,s=r[11].message+"",n;return{c(){t=Dt("pre"),e=H("ðŸ’¥ "),n=H(s)},l(a){t=Et(a,"PRE",{});var o=zt(t);e=L(o,"ðŸ’¥ "),n=L(o,s),o.forEach(B)},m(a,o){K(a,t,o),P(t,e),P(t,n)},p(a,o){o&2&&s!==(s=a[11].message+"")&&oe(n,s)},i:wt,o:wt,d(a){a&&B(t)}}}u(Hs,"create_catch_block");function Ls(r){let t,e,s,n,a,o,f=Ge(Object.entries(r[0].bindings)),p=[];for(let c=0;c<f.length;c+=1)p[c]=Ve(Ke(r,f,c));return a=new me({props:{client:r[3],$$slots:{default:[zs]},$$scope:{ctx:r}}}),{c(){t=Dt("ul");for(let c=0;c<p.length;c+=1)p[c].c();e=ue(),s=Dt("hr"),n=ue(),ps(a.$$.fragment)},l(c){t=Et(c,"UL",{});var b=zt(t);for(let h=0;h<p.length;h+=1)p[h].l(b);b.forEach(B),e=he(c),s=Et(c,"HR",{}),n=he(c),ys(a.$$.fragment,c)},m(c,b){K(c,t,b);for(let h=0;h<p.length;h+=1)p[h]&&p[h].m(t,null);K(c,e,b),K(c,s,b),K(c,n,b),ms(a,c,b),o=!0},p(c,b){if(b&5){f=Ge(Object.entries(c[0].bindings));let m;for(m=0;m<f.length;m+=1){const v=Ke(c,f,m);p[m]?p[m].p(v,b):(p[m]=Ve(v),p[m].c(),p[m].m(t,null))}for(;m<p.length;m+=1)p[m].d(1);p.length=f.length}const h={};b&32&&(h.$$scope={dirty:b,ctx:c}),a.$set(h)},i(c){o||(Kt(a.$$.fragment,c),o=!0)},o(c){Tt(a.$$.fragment,c),o=!1},d(c){c&&(B(t),B(e),B(s),B(n)),bs(p,c),ws(a,c)}}}u(Ls,"create_then_block");function Ve(r){let t,e,s,n=r[8]+"",a,o,f=r[6]+"",p,c,b;return{c(){t=Dt("li"),e=Dt("a"),s=H("["),a=H(n),o=H("] "),p=H(f),b=ue(),this.h()},l(h){t=Et(h,"LI",{});var m=zt(t);e=Et(m,"A",{href:!0});var v=zt(e);s=L(v,"["),a=L(v,n),o=L(v,"] "),p=L(v,f),v.forEach(B),b=he(m),m.forEach(B),this.h()},h(){ke(e,"href",c=`/${r[8]}/${r[6]}`)},m(h,m){K(h,t,m),P(t,e),P(e,s),P(e,a),P(e,o),P(e,p),P(t,b)},p(h,m){m&1&&n!==(n=h[8]+"")&&oe(a,n),m&1&&f!==(f=h[6]+"")&&oe(p,f),m&1&&c!==(c=`/${h[8]}/${h[6]}`)&&ke(e,"href",c)},d(h){h&&B(t)}}}u(Ve,"create_each_block");function zs(r){let t;const e=r[4].default,s=Le(e,r,r[5],null);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,a){s&&s.m(n,a),t=!0},p(n,a){s&&s.p&&(!t||a&32)&&ze(s,e,n,n[5],t?We(e,n[5],a,null):Je(n[5]),null)},i(n){t||(Kt(s,n),t=!0)},o(n){Tt(s,n),t=!1},d(n){s&&s.d(n)}}}u(zs,"create_default_slot");function Js(r){let t;return{c(){t=H("ðŸŒ€ Loading bindings...")},l(e){t=L(e,"ðŸŒ€ Loading bindings...")},m(e,s){K(e,t,s)},p:wt,i:wt,o:wt,d(e){e&&B(t)}}}u(Js,"create_pending_block");function Ws(r){let t,e,s,n={ctx:r,current:null,token:null,hasCatch:!0,pending:Js,then:Ls,catch:Hs,error:11,blocks:[,,,]};return $e(e=r[1],n),{c(){t=Ae(),n.block.c()},l(a){t=Ae(),n.block.l(a)},m(a,o){K(a,t,o),n.block.m(a,n.anchor=o),n.mount=()=>t.parentNode,n.anchor=t,s=!0},p(a,[o]){r=a,n.ctx=r,o&2&&e!==(e=r[1])&&$e(e,n)||As(n,r,o)},i(a){s||(Kt(n.block),s=!0)},o(a){for(let o=0;o<3;o+=1){const f=n.blocks[o];Tt(f)}s=!1},d(a){a&&B(t),n.block.d(a),n.token=null,n=null}}}u(Ws,"create_fragment");function Ys(r,t,e){let{$$slots:s={},$$scope:n}=t;const a=u(c=>({D1Database$:"d1",KVNamespace$:"kv",R2Bucket$:"r2"})[c]??"TODO-"+c,"ctorToType"),o={bindings:{}};ls("appContext",o);const f=new rs;let p=new Promise(()=>{});return Ye(()=>{e(1,p=fetch("/settings.json").then(c=>c.json()).then(c=>c.bridgeOrigin).then(c=>Gs(c).getBindings()).then(c=>(e(0,o.bindings=c,o),c)))}),r.$$set=c=>{"$$scope"in c&&e(5,n=c.$$scope)},[o,p,a,f,s,n]}u(Ys,"instance");const Re=class Re extends Ze{constructor(t){super(),ts(this,t,Ys,Ws,He,{})}};u(Re,"Layout");let Xe=Re;export{Xe as component};
