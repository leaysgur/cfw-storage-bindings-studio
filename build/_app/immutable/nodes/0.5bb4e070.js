var Ne=Object.defineProperty;var cs=(r,t,e)=>t in r?Ne(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var u=(r,t)=>Ne(r,"name",{value:t,configurable:!0});var I=(r,t,e)=>(cs(r,typeof t!="symbol"?t+"":t,e),e),ae=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var i=(r,t,e)=>(ae(r,t,"read from private field"),e?e.call(r):t.get(r)),f=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},d=(r,t,e,s)=>(ae(r,t,"write to private field"),s?s.call(r,e):t.set(r,e),e);var Xt=(r,t,e,s)=>({set _(n){d(r,t,n,e)},get _(){return i(r,t,s)}}),y=(r,t,e)=>(ae(r,t,"access private method"),e);import{i as os,g as us,c as Ht,f as hs,s as Le,d as ze,u as Je,e as We,h as Ye,o as Ze,j as ls,k as ds,n as wt}from"../chunks/scheduler.8c8bb1bf.js";import{p as fs,t as Tt,b as ps,d as Kt,S as ts,i as es,e as Ae,a as K,f as B,g as Et,m as H,h as It,j as zt,n as L,x as P,o as oe,s as ue,r as ys,c as he,u as ms,v as bs,y as ws,w as gs,k as ke}from"../chunks/index.c03294ce.js";import{r as Es,n as R,t as Is,c as Ds,a as v,i as re,b as _s,S as ss,h as ns,m as Ce,d as Ue,f as qe,o as Fe,e as vs,g as Qe,p as Pe,s as js,j as Ge}from"../chunks/context.5b4701d7.js";import{U as as,N as Ms,P as Os,a as Bs,b as rs,H as Ss,p as xe}from"../chunks/parse.457da179.js";import{R as Rs,M as Ns,i as As}from"../chunks/infiniteQueryBehavior.ef35ab7f.js";function $e(r,t){const e=t.token={};function s(n,a,o,p){if(t.token!==e)return;t.resolved=p;let l=t.ctx;o!==void 0&&(l=l.slice(),l[o]=p);const c=n&&(t.current=n)(l);let b=!1;t.block&&(t.blocks?t.blocks.forEach((h,m)=>{m!==a&&h&&(fs(),Tt(h,1,1,()=>{t.blocks[m]===h&&(t.blocks[m]=null)}),ps())}):t.block.d(1),c.c(),Kt(c,1),c.m(t.mount(),t.anchor),b=!0),t.block=c,t.blocks&&(t.blocks[a]=c),b&&hs()}if(u(s,"update"),os(r)){const n=us();if(r.then(a=>{Ht(n),s(t.then,1,t.value,a),Ht(null)},a=>{if(Ht(n),s(t.catch,2,t.error,a),Ht(null),!t.hasCatch)throw a}),t.current!==t.pending)return s(t.pending,0),!0}else{if(t.current!==t.then)return s(t.then,1,t.value,r),!0;t.resolved=r}}u($e,"handle_promise");function ks(r,t,e){const s=t.slice(),{resolved:n}=r;r.current===r.then&&(s[r.value]=n),r.current===r.catch&&(s[r.error]=n),r.block.p(s,e)}u(ks,"update_await_block_branch");const be=class be extends Error{constructor(t,e){super(t),this.name="DevalueError",this.path=e.join("")}};u(be,"DevalueError");let gt=be;function Te(r){return Object(r)!==r}u(Te,"is_primitive");const Cs=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Us(r){const t=Object.getPrototypeOf(r);return t===Object.prototype||t===null||Object.getOwnPropertyNames(t).sort().join("\0")===Cs}u(Us,"is_plain_object");function qs(r){return Object.prototype.toString.call(r).slice(8,-1)}u(qs,"get_type");function Fs(r){switch(r){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return r<" "?`\\u${r.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}u(Fs,"get_escaped_char");function st(r){let t="",e=0;const s=r.length;for(let n=0;n<s;n+=1){const a=r[n],o=Fs(a);o&&(t+=r.slice(e,n)+o,e=n+1)}return`"${e===0?r:t+r.slice(e)}"`}u(st,"stringify_string");function Vt(r,t){const e=[],s=new Map,n=[];for(const c in t)n.push({key:c,fn:t[c]});const a=[];let o=0;function p(c){if(typeof c=="function")throw new gt("Cannot stringify a function",a);if(s.has(c))return s.get(c);if(c===void 0)return as;if(Number.isNaN(c))return Ms;if(c===1/0)return Os;if(c===-1/0)return Bs;if(c===0&&1/c<0)return rs;const b=o++;s.set(c,b);for(const{key:m,fn:_}of n){const g=_(c);if(g)return e[b]=`["${m}",${p(g)}]`,b}let h="";if(Te(c))h=ie(c);else switch(qs(c)){case"Number":case"String":case"Boolean":h=`["Object",${ie(c)}]`;break;case"BigInt":h=`["BigInt",${c}]`;break;case"Date":h=`["Date","${c.toISOString()}"]`;break;case"RegExp":const{source:_,flags:g}=c;h=g?`["RegExp",${st(_)},"${g}"]`:`["RegExp",${st(_)}]`;break;case"Array":h="[";for(let w=0;w<c.length;w+=1)w>0&&(h+=","),w in c?(a.push(`[${w}]`),h+=p(c[w]),a.pop()):h+=Ss;h+="]";break;case"Set":h='["Set"';for(const w of c)h+=`,${p(w)}`;h+="]";break;case"Map":h='["Map"';for(const[w,S]of c)a.push(`.get(${Te(w)?ie(w):"..."})`),h+=`,${p(w)},${p(S)}`;h+="]";break;default:if(!Us(c))throw new gt("Cannot stringify arbitrary non-POJOs",a);if(Object.getOwnPropertySymbols(c).length>0)throw new gt("Cannot stringify POJOs with symbolic keys",a);if(Object.getPrototypeOf(c)===null){h='["null"';for(const w in c)a.push(`.${w}`),h+=`,${st(w)},${p(c[w])}`,a.pop();h+="]"}else{h="{";let w=!1;for(const S in c)w&&(h+=","),w=!0,a.push(`.${S}`),h+=`${st(S)}:${p(c[S])}`,a.pop();h+="}"}}return e[b]=h,b}u(p,"flatten");const l=p(r);return l<0?`${l}`:`[${e.join(",")}]`}u(Vt,"stringify");function ie(r){const t=typeof r;return t==="string"?st(r):r instanceof String?st(r.toString()):r===void 0?as.toString():r===0&&1/r<0?rs.toString():t==="bigint"?`["BigInt","${r}"]`:String(r)}u(ie,"stringify_primitive");const ce=u(r=>encodeURIComponent(r),"encodeKey$1");var Dt,_t,z,yt;const we=class we{constructor(t,e){f(this,z);f(this,Dt,void 0);f(this,_t,void 0);d(this,Dt,t),d(this,_t,e)}async list(t){return await(await y(this,z,yt).call(this,"KVNamespace.list",[t])).json()}async put(t,e,s){await y(this,z,yt).call(this,"KVNamespace.put",[ce(t),s],e)}async get(t,e){const{value:s}=await this.getWithMetadata(t,e);return s}async getWithMetadata(t,e){const s=await y(this,z,yt).call(this,"KVNamespace.getWithMetadata",[ce(t),e]);if(s.headers.get("X-BRIDGE-KV-ValueIsNull")==="true")return{value:null,metadata:null,cacheStatus:null};let n;typeof(e==null?void 0:e.type)=="string"?n=e.type:typeof e=="string"?n=e:n="text";let a;n==="json"&&(a=await s.json()),n==="text"&&(a=await s.text()),n==="arrayBuffer"&&(a=await s.arrayBuffer()),n==="stream"&&(a=s.body);const o=xe(s.headers.get("X-BRIDGE-KV-Metadata")??"[null]"),p=xe(s.headers.get("X-BRIDGE-KV-CacheStatus")??"[null]");return{value:a,metadata:o,cacheStatus:p}}async delete(t){await y(this,z,yt).call(this,"KVNamespace.delete",[ce(t)])}};Dt=new WeakMap,_t=new WeakMap,z=new WeakSet,yt=u(async function(t,e,s){const n=await fetch(i(this,Dt),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"KV","X-BRIDGE-BINDING-NAME":i(this,_t),"X-BRIDGE-KV-Dispatch":Vt({operation:t,parameters:e})},body:s,duplex:"half"});if(!n.ok){const a=await n.text();throw new Error(a)}return n},"#dispatch"),u(we,"KVNamespace$");let Jt=we;var vt,jt;const ge=class ge{constructor(t,e){f(this,vt,void 0);f(this,jt,void 0);d(this,vt,t),d(this,jt,e)}async fetch(t,e){const s=new Request(t,e),n=new Request(i(this,vt),s);return n.headers.set("X-BRIDGE-BINDING-MODULE","SERVICE"),n.headers.set("X-BRIDGE-BINDING-NAME",i(this,jt)),n.headers.set("X-BRIDGE-SERVICE-Dispatch",JSON.stringify({operation:"Fetcher.fetch",parameters:[s.url]})),fetch(n)}};vt=new WeakMap,jt=new WeakMap,u(ge,"Fetcher$");let Wt=ge;var Mt;const Ee=class Ee{constructor(t){f(this,Mt,void 0);d(this,Mt,t)}async fetch(t,e){const s=new Request(t,e),n=new URL(s.url),a=new URL(i(this,Mt));return n.protocol=a.protocol,n.host=a.host,fetch(n,s)}};Mt=new WeakMap,u(Ee,"DirectFetcher$");let le=Ee;const pt=u(r=>{const t=new Uint8Array(r.length/2);for(let e=0;e<r.length;e+=2)t[e/2]=parseInt(r.substring(e,e+2),16);return t.buffer},"hexStringToArrayBuffer"),Qs=u(r=>{const t=new Uint8Array(r);let e="";for(let s=0;s<t.length;s++){const n=t[s].toString(16);e+=n.length===1?"0"+n:n}return e},"arrayBufferToHexString"),F=u(r=>encodeURIComponent(r),"encodeKey");var Ot;const Ie=class Ie{constructor(t){f(this,Ot,void 0);I(this,"md5");I(this,"sha1");I(this,"sha256");I(this,"sha384");I(this,"sha512");d(this,Ot,t),this.md5=t.md5?pt(t.md5):void 0,this.sha1=t.sha1?pt(t.sha1):void 0,this.sha256=t.sha256?pt(t.sha256):void 0,this.sha384=t.sha384?pt(t.sha384):void 0,this.sha512=t.sha512?pt(t.sha512):void 0,Object.freeze(this)}toJSON(){return i(this,Ot)}};Ot=new WeakMap,u(Ie,"Checksums$");let de=Ie;const De=class De{constructor(t){I(this,"key");I(this,"version");I(this,"size");I(this,"etag");I(this,"httpEtag");I(this,"checksums");I(this,"uploaded");I(this,"httpMetadata");I(this,"customMetadata");I(this,"range");this.key=t.key,this.version=t.version,this.size=t.size,this.etag=t.etag,this.httpEtag=t.httpEtag,this.checksums=new de(t.checksums),this.uploaded=new Date(t.uploaded),this.httpMetadata={...t.httpMetadata,cacheExpiry:t.httpMetadata.cacheExpiry?new Date(t.httpMetadata.cacheExpiry):void 0},t.httpMetadata.cacheExpiry||delete this.httpMetadata.cacheExpiry,this.customMetadata=t.customMetadata,this.range=t.range,Object.freeze(this)}writeHttpMetadata(t){var e,s,n,a,o,p;(e=this.httpMetadata)!=null&&e.contentType&&t.set("content-type",this.httpMetadata.contentType),(s=this.httpMetadata)!=null&&s.contentLanguage&&t.set("content-language",this.httpMetadata.contentLanguage),(n=this.httpMetadata)!=null&&n.contentDisposition&&t.set("content-disposition",this.httpMetadata.contentDisposition),(a=this.httpMetadata)!=null&&a.contentEncoding&&t.set("content-encoding",this.httpMetadata.contentEncoding),(o=this.httpMetadata)!=null&&o.cacheControl&&t.set("cache-control",this.httpMetadata.cacheControl),(p=this.httpMetadata)!=null&&p.cacheExpiry&&t.set("expires",this.httpMetadata.cacheExpiry.toUTCString())}};u(De,"HeadResult$");let V=De;var k;const _e=class _e extends V{constructor(e,s){super(e);f(this,k,void 0);d(this,k,s)}get body(){return i(this,k).body??new ReadableStream}get bodyUsed(){return i(this,k).bodyUsed}async arrayBuffer(){return i(this,k).arrayBuffer()}async text(){return i(this,k).text()}async json(){return i(this,k).json()}async blob(){return i(this,k).blob()}};k=new WeakMap,u(_e,"GetResult$");let fe=_e;var J;const ve=class ve{constructor({key:t,uploadId:e},s){f(this,J,void 0);I(this,"key");I(this,"uploadId");d(this,J,s),this.key=t,this.uploadId=e,Object.freeze(this)}async uploadPart(t,e){return await(await i(this,J).call(this,"R2MultipartUpload.uploadPart",[F(this.key),this.uploadId,t],e)).json()}async abort(){await i(this,J).call(this,"R2MultipartUpload.abort",[F(this.key),this.uploadId])}async complete(t){const s=await(await i(this,J).call(this,"R2MultipartUpload.complete",[F(this.key),this.uploadId,t])).json();return new V(s)}};J=new WeakMap,u(ve,"R2MultipartUpload$");let Yt=ve;var Bt,St,N,U;const je=class je{constructor(t,e){f(this,N);f(this,Bt,void 0);f(this,St,void 0);d(this,Bt,t),d(this,St,e)}async list(t){const s=await(await y(this,N,U).call(this,"R2Bucket.list",[t])).json();return{...s,objects:s.objects.map(n=>new V(n))}}async put(t,e,s){const a=await(await y(this,N,U).call(this,"R2Bucket.put",[F(t),null,s],e??void 0)).json();return a===null?null:new V(a)}async get(t,e){const s=await y(this,N,U).call(this,"R2Bucket.get",[F(t),e]),n=s.headers.get("X-BRIDGE-R2-R2ObjectJSON");if(n){const o=JSON.parse(n);return new fe(o,s)}const a=await s.json();return a===null?null:new V(a)}async head(t){const s=await(await y(this,N,U).call(this,"R2Bucket.head",[F(t)])).json();return s===null?null:new V(s)}async delete(t){t=typeof t=="string"?F(t):t.map(e=>F(e)),await y(this,N,U).call(this,"R2Bucket.delete",[t])}async createMultipartUpload(t,e){const n=await(await y(this,N,U).call(this,"R2Bucket.createMultipartUpload",[F(t),e])).json();return new Yt(n,y(this,N,U).bind(this))}resumeMultipartUpload(t,e){return new Yt({key:t,uploadId:e},y(this,N,U).bind(this))}};Bt=new WeakMap,St=new WeakMap,N=new WeakSet,U=u(async function(t,e,s){const n=await fetch(i(this,Bt),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"R2","X-BRIDGE-BINDING-NAME":i(this,St),"X-BRIDGE-R2-Dispatch":Vt({operation:t,parameters:e},{Headers:a=>a instanceof Headers&&Array.from(a),ArrayBuffer:a=>a instanceof ArrayBuffer&&Qs(a)})},body:s,duplex:"half"});if(!n.ok){const a=await n.text();throw new Error(a)}return n},"#dispatch"),u(je,"R2Bucket$");let Zt=je;const Ps=u(r=>r.map(t=>t instanceof ArrayBuffer?Array.from(new Uint8Array(t)):ArrayBuffer.isView(t)?Array.from(t):t),"encodeBindValues");var W,nt,at,Y,mt;const ne=class ne{constructor(t,e,s){f(this,Y);f(this,W,void 0);f(this,nt,void 0);f(this,at,void 0);d(this,W,t),d(this,nt,e),d(this,at,s)}get statement(){return i(this,W)}get params(){return i(this,nt)}bind(...t){return new ne(i(this,W),Ps(t),i(this,at))}async first(t){return y(this,Y,mt).call(this,"D1PreparedStatement.first",t)}async run(){return y(this,Y,mt).call(this,"D1PreparedStatement.run")}async all(){return y(this,Y,mt).call(this,"D1PreparedStatement.all")}async raw(){return y(this,Y,mt).call(this,"D1PreparedStatement.raw")}};W=new WeakMap,nt=new WeakMap,at=new WeakMap,Y=new WeakSet,mt=u(async function(t,e){return await(await i(this,at).call(this,t,[i(this,W),i(this,nt),e])).json()},"#send"),u(ne,"D1PreparedStatement$");let pe=ne;var Rt,Nt,Z,bt;const Me=class Me{constructor(t,e){f(this,Z);f(this,Rt,void 0);f(this,Nt,void 0);d(this,Rt,t),d(this,Nt,e)}prepare(t){return new pe(t,[],y(this,Z,bt).bind(this))}async dump(){return await(await y(this,Z,bt).call(this,"D1Database.dump",[])).arrayBuffer()}async batch(t){return await(await y(this,Z,bt).call(this,"D1Database.batch",[t.map(n=>{const a=n;return[a.statement,a.params]})])).json()}async exec(t){return await(await y(this,Z,bt).call(this,"D1Database.exec",[t])).json()}};Rt=new WeakMap,Nt=new WeakMap,Z=new WeakSet,bt=u(async function(t,e){const s=await fetch(i(this,Rt),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"D1","X-BRIDGE-BINDING-NAME":i(this,Nt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Me,"D1Database$");let te=Me;var At,kt,Ct,ye;const Oe=class Oe{constructor(t,e){f(this,Ct);f(this,At,void 0);f(this,kt,void 0);d(this,At,t),d(this,kt,e)}async send(t,e){await y(this,Ct,ye).call(this,"Queue.send",[t,e])}async sendBatch(t){await y(this,Ct,ye).call(this,"Queue.sendBatch",[t])}};At=new WeakMap,kt=new WeakMap,Ct=new WeakSet,ye=u(async function(t,e){const s=await fetch(i(this,At),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"QUEUE","X-BRIDGE-BINDING-NAME":i(this,kt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Oe,"WorkerQueue$");let ee=Oe;var Ut,qt,Q,X;const Be=class Be{constructor(t,e){f(this,Q);f(this,Ut,void 0);f(this,qt,void 0);d(this,Ut,t),d(this,qt,e)}async describe(){return await(await y(this,Q,X).call(this,"VectorizeIndex.describe",[])).json()}async query(t,e){return await(await y(this,Q,X).call(this,"VectorizeIndex.query",[t,e])).json()}async insert(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.insert",[t])).json()}async upsert(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.upsert",[t])).json()}async deleteByIds(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.deleteByIds",[t])).json()}async getByIds(t){return await(await y(this,Q,X).call(this,"VectorizeIndex.getByIds",[t])).json()}};Ut=new WeakMap,qt=new WeakMap,Q=new WeakSet,X=u(async function(t,e){const s=await fetch(i(this,Ut),{method:"POST",headers:{"X-BRIDGE-BINDING-MODULE":"VECTORIZE","X-BRIDGE-BINDING-NAME":i(this,qt)},body:Vt({operation:t,parameters:e})});if(!s.ok){const n=await s.text();throw new Error(n)}return s},"#dispatch"),u(Be,"VectorizeIndex$");let se=Be;const Gs=u(async r=>{const t=new URL("/_internals/getBindings",r),s=await(await fetch(t,{headers:{"content-type":"application/json"}})).json(),n={};for(const[a,o]of Object.entries(s))o==="d1"&&(n[a]=new te(r,a)),o==="kv"&&(n[a]=new Jt(r,a)),o==="queue"&&(n[a]=new ee(r,a)),o==="r2"&&(n[a]=new Zt(r,a)),o==="service"&&(n[a]=new Wt(r,a)),o==="vectorize"&&(n[a]=new se(r,a));return n},"getBindings"),xs=u((r="http://127.0.0.1:8787")=>({getBindings:()=>Gs(r),KVNamespace:t=>new Jt(r,t),Fetcher:(t,e)=>e?new le(e):new Wt(r,t),R2Bucket:t=>new Zt(r,t),D1Database:t=>new te(r,t),Queue:t=>new ee(r,t),VectorizeIndex:t=>new se(r,t)}),"createBridge");var rt,it,j,G,M,D,Ft,tt,ct,Lt,A,q,Qt,$s=(Qt=class extends Rs{constructor(e){super();f(this,ct);f(this,A);f(this,rt,void 0);f(this,it,void 0);f(this,j,void 0);f(this,G,void 0);f(this,M,void 0);f(this,D,void 0);f(this,Ft,void 0);f(this,tt,void 0);d(this,tt,!1),d(this,Ft,e.defaultOptions),y(this,ct,Lt).call(this,e.options),d(this,D,[]),d(this,j,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,d(this,rt,e.state||Ts(this.options)),this.state=i(this,rt),this.scheduleGc()}get meta(){return this.options.meta}optionalRemove(){!i(this,D).length&&this.state.fetchStatus==="idle"&&i(this,j).remove(this)}setData(e,s){const n=Es(this.state.data,e,this.options);return y(this,A,q).call(this,{data:n,type:"success",dataUpdatedAt:s==null?void 0:s.updatedAt,manual:s==null?void 0:s.manual}),n}setState(e,s){y(this,A,q).call(this,{type:"setState",state:e,setStateOptions:s})}cancel(e){var n;const s=i(this,G);return(n=i(this,M))==null||n.cancel(e),s?s.then(R).catch(R):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(i(this,rt))}isActive(){return i(this,D).some(e=>e.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||i(this,D).some(e=>e.getCurrentResult().isStale)}isStaleByTime(e=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Is(this.state.dataUpdatedAt,e)}onFocus(){var s;const e=i(this,D).find(n=>n.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,M))==null||s.continue()}onOnline(){var s;const e=i(this,D).find(n=>n.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(s=i(this,M))==null||s.continue()}addObserver(e){i(this,D).includes(e)||(i(this,D).push(e),this.clearGcTimeout(),i(this,j).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){i(this,D).includes(e)&&(d(this,D,i(this,D).filter(s=>s!==e)),i(this,D).length||(i(this,M)&&(i(this,tt)?i(this,M).cancel({revert:!0}):i(this,M).cancelRetry()),this.scheduleGc()),i(this,j).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return i(this,D).length}invalidate(){this.state.isInvalidated||y(this,A,q).call(this,{type:"invalidate"})}fetch(e,s){var b,h,m,_;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&(s!=null&&s.cancelRefetch))this.cancel({silent:!0});else if(i(this,G))return(b=i(this,M))==null||b.continueRetry(),i(this,G)}if(e&&y(this,ct,Lt).call(this,e),!this.options.queryFn){const g=i(this,D).find(w=>w.options.queryFn);g&&y(this,ct,Lt).call(this,g.options)}const n=new AbortController,a={queryKey:this.queryKey,meta:this.meta},o=u(g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(d(this,tt,!0),n.signal)})},"addSignalProperty");o(a);const p=u(()=>this.options.queryFn?(d(this,tt,!1),this.options.persister?this.options.persister(this.options.queryFn,a,this):this.options.queryFn(a)):Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)),"fetchFn"),l={fetchOptions:s,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:p};o(l),(h=this.options.behavior)==null||h.onFetch(l,this),d(this,it,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((m=l.fetchOptions)==null?void 0:m.meta))&&y(this,A,q).call(this,{type:"fetch",meta:(_=l.fetchOptions)==null?void 0:_.meta});const c=u(g=>{var w,S,dt,ft;re(g)&&g.silent||y(this,A,q).call(this,{type:"error",error:g}),re(g)||((S=(w=i(this,j).config).onError)==null||S.call(w,g,this),(ft=(dt=i(this,j).config).onSettled)==null||ft.call(dt,this.state.data,g,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},"onError");return d(this,M,Ds({fn:l.fetchFn,abort:n.abort.bind(n),onSuccess:g=>{var w,S,dt,ft;if(typeof g>"u"){c(new Error(`${this.queryHash} data is undefined`));return}this.setData(g),(S=(w=i(this,j).config).onSuccess)==null||S.call(w,g,this),(ft=(dt=i(this,j).config).onSettled)==null||ft.call(dt,g,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:c,onFail:(g,w)=>{y(this,A,q).call(this,{type:"failed",failureCount:g,error:w})},onPause:()=>{y(this,A,q).call(this,{type:"pause"})},onContinue:()=>{y(this,A,q).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode})),d(this,G,i(this,M).promise),i(this,G)}},rt=new WeakMap,it=new WeakMap,j=new WeakMap,G=new WeakMap,M=new WeakMap,D=new WeakMap,Ft=new WeakMap,tt=new WeakMap,ct=new WeakSet,Lt=u(function(e){this.options={...i(this,Ft),...e},this.updateGcTime(this.options.gcTime)},"#setOptions"),A=new WeakSet,q=u(function(e){const s=u(n=>{switch(e.type){case"failed":return{...n,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...n,fetchStatus:"paused"};case"continue":return{...n,fetchStatus:"fetching"};case"fetch":return{...n,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:e.meta??null,fetchStatus:_s(this.options.networkMode)?"fetching":"paused",...!n.dataUpdatedAt&&{error:null,status:"pending"}};case"success":return{...n,data:e.data,dataUpdateCount:n.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=e.error;return re(a)&&a.revert&&i(this,it)?{...i(this,it),fetchStatus:"idle"}:{...n,error:a,errorUpdateCount:n.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:n.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...n,isInvalidated:!0};case"setState":return{...n,...e.state}}},"reducer");this.state=s(this.state),v.batch(()=>{i(this,D).forEach(n=>{n.onQueryUpdate()}),i(this,j).notify({query:this,type:"updated",action:e})})},"#dispatch"),u(Qt,"Query"),Qt);function Ts(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=typeof t<"u",s=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}u(Ts,"getDefaultState");var C,Pt,Ks=(Pt=class extends ss{constructor(e={}){super();f(this,C,void 0);this.config=e,d(this,C,new Map)}build(e,s,n){const a=s.queryKey,o=s.queryHash??ns(a,s);let p=this.get(o);return p||(p=new $s({cache:this,queryKey:a,queryHash:o,options:e.defaultQueryOptions(s),state:n,defaultOptions:e.getQueryDefaults(a)}),this.add(p)),p}add(e){i(this,C).has(e.queryHash)||(i(this,C).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const s=i(this,C).get(e.queryHash);s&&(e.destroy(),s===e&&i(this,C).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){v.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return i(this,C).get(e)}getAll(){return[...i(this,C).values()]}find(e){const s={exact:!0,...e};return this.getAll().find(n=>Ce(s,n))}findAll(e={}){const s=this.getAll();return Object.keys(e).length>0?s.filter(n=>Ce(e,n)):s}notify(e){v.batch(()=>{this.listeners.forEach(s=>{s(e)})})}onFocus(){v.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){v.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},C=new WeakMap,u(Pt,"QueryCache"),Pt),O,Gt,et,xt,Vs=(xt=class extends ss{constructor(e={}){super();f(this,O,void 0);f(this,Gt,void 0);f(this,et,void 0);this.config=e,d(this,O,[]),d(this,Gt,0)}build(e,s,n){const a=new Ns({mutationCache:this,mutationId:++Xt(this,Gt)._,options:e.defaultMutationOptions(s),state:n});return this.add(a),a}add(e){i(this,O).push(e),this.notify({type:"added",mutation:e})}remove(e){d(this,O,i(this,O).filter(s=>s!==e)),this.notify({type:"removed",mutation:e})}clear(){v.batch(()=>{i(this,O).forEach(e=>{this.remove(e)})})}getAll(){return i(this,O)}find(e){const s={exact:!0,...e};return i(this,O).find(n=>Ue(s,n))}findAll(e={}){return i(this,O).filter(s=>Ue(e,s))}notify(e){v.batch(()=>{this.listeners.forEach(s=>{s(e)})})}resumePausedMutations(){return d(this,et,(i(this,et)??Promise.resolve()).then(()=>{const e=i(this,O).filter(s=>s.state.isPaused);return v.batch(()=>e.reduce((s,n)=>s.then(()=>n.continue().catch(R)),Promise.resolve()))}).then(()=>{d(this,et,void 0)})),i(this,et)}},O=new WeakMap,Gt=new WeakMap,et=new WeakMap,u(xt,"MutationCache"),xt),E,x,$,ot,ut,T,ht,lt,$t,is=($t=class{constructor(t={}){f(this,E,void 0);f(this,x,void 0);f(this,$,void 0);f(this,ot,void 0);f(this,ut,void 0);f(this,T,void 0);f(this,ht,void 0);f(this,lt,void 0);d(this,E,t.queryCache||new Ks),d(this,x,t.mutationCache||new Vs),d(this,$,t.defaultOptions||{}),d(this,ot,new Map),d(this,ut,new Map),d(this,T,0)}mount(){Xt(this,T)._++,i(this,T)===1&&(d(this,ht,qe.subscribe(()=>{qe.isFocused()&&(this.resumePausedMutations(),i(this,E).onFocus())})),d(this,lt,Fe.subscribe(()=>{Fe.isOnline()&&(this.resumePausedMutations(),i(this,E).onOnline())})))}unmount(){var t,e;Xt(this,T)._--,i(this,T)===0&&((t=i(this,ht))==null||t.call(this),d(this,ht,void 0),(e=i(this,lt))==null||e.call(this),d(this,lt,void 0))}isFetching(t){return i(this,E).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return i(this,x).findAll({...t,status:"pending"}).length}getQueryData(t){var e;return(e=i(this,E).find({queryKey:t}))==null?void 0:e.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);return e!==void 0?Promise.resolve(e):this.fetchQuery(t)}getQueriesData(t){return this.getQueryCache().findAll(t).map(({queryKey:e,state:s})=>{const n=s.data;return[e,n]})}setQueryData(t,e,s){const n=i(this,E).find({queryKey:t}),a=n==null?void 0:n.state.data,o=vs(e,a);if(typeof o>"u")return;const p=this.defaultQueryOptions({queryKey:t});return i(this,E).build(this,p).setData(o,{...s,manual:!0})}setQueriesData(t,e,s){return v.batch(()=>this.getQueryCache().findAll(t).map(({queryKey:n})=>[n,this.setQueryData(n,e,s)]))}getQueryState(t){var e;return(e=i(this,E).find({queryKey:t}))==null?void 0:e.state}removeQueries(t){const e=i(this,E);v.batch(()=>{e.findAll(t).forEach(s=>{e.remove(s)})})}resetQueries(t,e){const s=i(this,E),n={type:"active",...t};return v.batch(()=>(s.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries(n,e)))}cancelQueries(t={},e={}){const s={revert:!0,...e},n=v.batch(()=>i(this,E).findAll(t).map(a=>a.cancel(s)));return Promise.all(n).then(R).catch(R)}invalidateQueries(t={},e={}){return v.batch(()=>{if(i(this,E).findAll(t).forEach(n=>{n.invalidate()}),t.refetchType==="none")return Promise.resolve();const s={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(s,e)})}refetchQueries(t={},e){const s={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},n=v.batch(()=>i(this,E).findAll(t).filter(a=>!a.isDisabled()).map(a=>{let o=a.fetch(void 0,s);return s.throwOnError||(o=o.catch(R)),a.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(R)}fetchQuery(t){const e=this.defaultQueryOptions(t);typeof e.retry>"u"&&(e.retry=!1);const s=i(this,E).build(this,e);return s.isStaleByTime(e.staleTime)?s.fetch(e):Promise.resolve(s.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(R).catch(R)}fetchInfiniteQuery(t){return t.behavior=As(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(R).catch(R)}resumePausedMutations(){return i(this,x).resumePausedMutations()}getQueryCache(){return i(this,E)}getMutationCache(){return i(this,x)}getDefaultOptions(){return i(this,$)}setDefaultOptions(t){d(this,$,t)}setQueryDefaults(t,e){i(this,ot).set(Qe(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...i(this,ot).values()];let s={};return e.forEach(n=>{Pe(t,n.queryKey)&&(s={...s,...n.defaultOptions})}),s}setMutationDefaults(t,e){i(this,ut).set(Qe(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...i(this,ut).values()];let s={};return e.forEach(n=>{Pe(t,n.mutationKey)&&(s={...s,...n.defaultOptions})}),s}defaultQueryOptions(t){if(t!=null&&t._defaulted)return t;const e={...i(this,$).queries,...(t==null?void 0:t.queryKey)&&this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ns(e.queryKey,e)),typeof e.refetchOnReconnect>"u"&&(e.refetchOnReconnect=e.networkMode!=="always"),typeof e.throwOnError>"u"&&(e.throwOnError=!!e.suspense),typeof e.networkMode>"u"&&e.persister&&(e.networkMode="offlineFirst"),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...i(this,$).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){i(this,E).clear(),i(this,x).clear()}},E=new WeakMap,x=new WeakMap,$=new WeakMap,ot=new WeakMap,ut=new WeakMap,T=new WeakMap,ht=new WeakMap,lt=new WeakMap,u($t,"QueryClient"),$t);function Xs(r){let t;const e=r[2].default,s=ze(e,r,r[1],null);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,a){s&&s.m(n,a),t=!0},p(n,[a]){s&&s.p&&(!t||a&2)&&Je(s,e,n,n[1],t?Ye(e,n[1],a,null):We(n[1]),null)},i(n){t||(Kt(s,n),t=!0)},o(n){Tt(s,n),t=!1},d(n){s&&s.d(n)}}}u(Xs,"create_fragment$1");function Hs(r,t,e){let{$$slots:s={},$$scope:n}=t,{client:a=new is}=t;return Ze(()=>{a.mount()}),js(a),ls(()=>{a.unmount()}),r.$$set=o=>{"client"in o&&e(0,a=o.client),"$$scope"in o&&e(1,n=o.$$scope)},[a,n,s]}u(Hs,"instance$1");const Se=class Se extends ts{constructor(t){super(),es(this,t,Hs,Xs,Le,{client:0})}};u(Se,"QueryClientProvider");let me=Se;function Ke(r,t,e){const s=r.slice();s[5]=t[e][0],s[6]=t[e][1];const n=s[2][s[6].constructor.name]??"-";return s[7]=n,s}u(Ke,"get_each_context");function Ls(r){let t,e,s=r[10].message+"",n;return{c(){t=Et("pre"),e=H("💥 "),n=H(s)},l(a){t=It(a,"PRE",{});var o=zt(t);e=L(o,"💥 "),n=L(o,s),o.forEach(B)},m(a,o){K(a,t,o),P(t,e),P(t,n)},p(a,o){o&2&&s!==(s=a[10].message+"")&&oe(n,s)},i:wt,o:wt,d(a){a&&B(t)}}}u(Ls,"create_catch_block");function zs(r){let t,e,s,n,a,o,p=Ge(Object.entries(r[0].bindings).sort(Xe)),l=[];for(let c=0;c<p.length;c+=1)l[c]=Ve(Ke(r,p,c));return a=new me({props:{client:new is,$$slots:{default:[Js]},$$scope:{ctx:r}}}),{c(){t=Et("ul");for(let c=0;c<l.length;c+=1)l[c].c();e=ue(),s=Et("hr"),n=ue(),ys(a.$$.fragment)},l(c){t=It(c,"UL",{});var b=zt(t);for(let h=0;h<l.length;h+=1)l[h].l(b);b.forEach(B),e=he(c),s=It(c,"HR",{}),n=he(c),ms(a.$$.fragment,c)},m(c,b){K(c,t,b);for(let h=0;h<l.length;h+=1)l[h]&&l[h].m(t,null);K(c,e,b),K(c,s,b),K(c,n,b),bs(a,c,b),o=!0},p(c,b){if(b&5){p=Ge(Object.entries(c[0].bindings).sort(Xe));let m;for(m=0;m<p.length;m+=1){const _=Ke(c,p,m);l[m]?l[m].p(_,b):(l[m]=Ve(_),l[m].c(),l[m].m(t,null))}for(;m<l.length;m+=1)l[m].d(1);l.length=p.length}const h={};b&16&&(h.$$scope={dirty:b,ctx:c}),a.$set(h)},i(c){o||(Kt(a.$$.fragment,c),o=!0)},o(c){Tt(a.$$.fragment,c),o=!1},d(c){c&&(B(t),B(e),B(s),B(n)),ws(l,c),gs(a,c)}}}u(zs,"create_then_block");function Ve(r){let t,e,s,n=r[7]+"",a,o,p=r[5]+"",l,c,b;return{c(){t=Et("li"),e=Et("a"),s=H("["),a=H(n),o=H("] "),l=H(p),b=ue(),this.h()},l(h){t=It(h,"LI",{});var m=zt(t);e=It(m,"A",{href:!0});var _=zt(e);s=L(_,"["),a=L(_,n),o=L(_,"] "),l=L(_,p),_.forEach(B),b=he(m),m.forEach(B),this.h()},h(){ke(e,"href",c=`/${r[7]}/${r[5]}`)},m(h,m){K(h,t,m),P(t,e),P(e,s),P(e,a),P(e,o),P(e,l),P(t,b)},p(h,m){m&1&&n!==(n=h[7]+"")&&oe(a,n),m&1&&p!==(p=h[5]+"")&&oe(l,p),m&1&&c!==(c=`/${h[7]}/${h[5]}`)&&ke(e,"href",c)},d(h){h&&B(t)}}}u(Ve,"create_each_block");function Js(r){let t;const e=r[3].default,s=ze(e,r,r[4],null);return{c(){s&&s.c()},l(n){s&&s.l(n)},m(n,a){s&&s.m(n,a),t=!0},p(n,a){s&&s.p&&(!t||a&16)&&Je(s,e,n,n[4],t?Ye(e,n[4],a,null):We(n[4]),null)},i(n){t||(Kt(s,n),t=!0)},o(n){Tt(s,n),t=!1},d(n){s&&s.d(n)}}}u(Js,"create_default_slot");function Ws(r){let t;return{c(){t=H("🌀 Loading bindings...")},l(e){t=L(e,"🌀 Loading bindings...")},m(e,s){K(e,t,s)},p:wt,i:wt,o:wt,d(e){e&&B(t)}}}u(Ws,"create_pending_block");function Ys(r){let t,e,s,n={ctx:r,current:null,token:null,hasCatch:!0,pending:Ws,then:zs,catch:Ls,error:10,blocks:[,,,]};return $e(e=r[1],n),{c(){t=Ae(),n.block.c()},l(a){t=Ae(),n.block.l(a)},m(a,o){K(a,t,o),n.block.m(a,n.anchor=o),n.mount=()=>t.parentNode,n.anchor=t,s=!0},p(a,[o]){r=a,n.ctx=r,o&2&&e!==(e=r[1])&&$e(e,n)||ks(n,r,o)},i(a){s||(Kt(n.block),s=!0)},o(a){for(let o=0;o<3;o+=1){const p=n.blocks[o];Tt(p)}s=!1},d(a){a&&B(t),n.block.d(a),n.token=null,n=null}}}u(Ys,"create_fragment");const Xe=u(([r],[t])=>r.localeCompare(t),"func");function Zs(r,t,e){let{$$slots:s={},$$scope:n}=t;const a={D1Database$:"d1",KVNamespace$:"kv",R2Bucket$:"r2"},o={bindings:{}};ds("appContext",o);let p=new Promise(()=>{});return Ze(()=>{e(1,p=fetch("/settings.json").then(l=>l.json()).then(l=>l.bridgeOrigin).then(l=>xs(l).getBindings()).then(l=>(e(0,o.bindings=l,o),l)))}),r.$$set=l=>{"$$scope"in l&&e(4,n=l.$$scope)},[o,p,a,s,n]}u(Zs,"instance");const Re=class Re extends ts{constructor(t){super(),es(this,t,Zs,Ys,Le,{})}};u(Re,"Layout");let He=Re;export{He as component};
