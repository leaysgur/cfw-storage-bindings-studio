var Fe=Object.defineProperty;var m=(n,e)=>Fe(n,"name",{value:e,configurable:!0});var se=(n,e,t)=>{if(!e.has(n))throw TypeError("Cannot "+t)};var k=(n,e,t)=>(se(n,e,"read from private field"),t?t.call(n):e.get(n)),A=(n,e,t)=>{if(e.has(n))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(n):e.set(n,t)},j=(n,e,t,i)=>(se(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t);var I=(n,e,t)=>(se(n,e,"access private method"),t);import{q as Le,s as ue,n as q,r as Re,p as Qe,l as W,m as Be}from"../chunks/scheduler.8c8bb1bf.js";import{S as oe,i as ce,g as N,s as V,m as Q,h as M,j as R,c as C,f as g,n as S,k as ke,a as y,x as P,A as z,z as w,B as we,e as D,o as $,r as Se,u as Ke,v as Ve,t as H,b as fe,d as U,w as Ce,p as he,C as Ue,y as De}from"../chunks/index.934348cb.js";import{S as Ae,k as je,a as qe,j as x,u as He,l as Ie}from"../chunks/context.f1412b6d.js";import{Q as ze,a as Xe,u as ee,i as Ye,c as Ge}from"../chunks/createQuery.03e5834d.js";import{i as ye,h as Je,a as We,g as Ze}from"../chunks/infiniteQueryBehavior.e2cd4775.js";import{p as xe}from"../chunks/stores.03e19ac2.js";import{r as ve,d as $e}from"../chunks/index.e2fc19a5.js";var Y,et=(Y=class extends ze{constructor(e,t){super(e,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(e,t){super.setOptions({...e,behavior:ye()},t)}getOptimisticResult(e){return e.behavior=ye(),super.getOptimisticResult(e)}fetchNextPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(e){return this.fetch({...e,meta:{fetchMore:{direction:"backward"}}})}createResult(e,t){var f,h,_,u;const{state:i}=e,r=super.createResult(e,t),{isFetching:s,isRefetching:c}=r,a=s&&((h=(f=i.fetchMeta)==null?void 0:f.fetchMore)==null?void 0:h.direction)==="forward",l=s&&((u=(_=i.fetchMeta)==null?void 0:_.fetchMore)==null?void 0:u.direction)==="backward";return{...r,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:Je(t,i.data),hasPreviousPage:We(t,i.data),isFetchingNextPage:a,isFetchingPreviousPage:l,isRefetching:c&&!a&&!l}}},m(Y,"InfiniteQueryObserver"),Y),B,T,K,F,X,Z,G,ne,J,tt=(J=class extends Ae{constructor(t,i){super();A(this,X);A(this,G);A(this,B,void 0);A(this,T,void 0);A(this,K,void 0);A(this,F,void 0);j(this,T,void 0),j(this,B,t),this.setOptions(i),this.bindMethods(),I(this,X,Z).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const i=this.options;this.options=k(this,B).defaultMutationOptions(t),je(i,this.options)||k(this,B).getMutationCache().notify({type:"observerOptionsUpdated",mutation:k(this,K),observer:this}),(r=k(this,K))==null||r.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=k(this,K))==null||t.removeObserver(this)}onMutationUpdate(t){I(this,X,Z).call(this),I(this,G,ne).call(this,t)}getCurrentResult(){return k(this,T)}reset(){j(this,K,void 0),I(this,X,Z).call(this),I(this,G,ne).call(this)}mutate(t,i){var r;return j(this,F,i),(r=k(this,K))==null||r.removeObserver(this),j(this,K,k(this,B).getMutationCache().build(k(this,B),this.options)),k(this,K).addObserver(this),k(this,K).execute(t)}},B=new WeakMap,T=new WeakMap,K=new WeakMap,F=new WeakMap,X=new WeakSet,Z=m(function(){var i;const t=((i=k(this,K))==null?void 0:i.state)??Ze();j(this,T,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},"#updateResult"),G=new WeakSet,ne=m(function(t){qe.batch(()=>{var i,r,s,c,a,l,f,h;k(this,F)&&this.hasListeners()&&((t==null?void 0:t.type)==="success"?((r=(i=k(this,F)).onSuccess)==null||r.call(i,t.data,k(this,T).variables,k(this,T).context),(c=(s=k(this,F)).onSettled)==null||c.call(s,t.data,null,k(this,T).variables,k(this,T).context)):(t==null?void 0:t.type)==="error"&&((l=(a=k(this,F)).onError)==null||l.call(a,t.error,k(this,T).variables,k(this,T).context),(h=(f=k(this,F)).onSettled)==null||h.call(f,void 0,t.error,k(this,T).variables,k(this,T).context))),this.listeners.forEach(_=>{_(k(this,T))})})},"#notify"),m(J,"MutationObserver"),J);function it(n,e){return Xe(n,et,e)}m(it,"createInfiniteQuery");function re(n,e){const t=ee(e),i=Ye(n)?n:ve(n),r=new tt(t,Le(i));let s;i.subscribe(l=>{s=m((f,h)=>{r.mutate(f,h).catch(st)},"mutate"),r.setOptions(l)});const c=ve(r.getCurrentResult(),l=>r.subscribe(qe.batchCalls(f=>l(f)))),{subscribe:a}=$e(c,l=>({...l,mutate:s,mutateAsync:l.mutate}));return{subscribe:a}}m(re,"createMutation");function st(){}m(st,"noop");function nt(n){let e,t,i,r,s,c,a,l,f,h;return{c(){e=N("form"),t=N("input"),i=V(),r=N("textarea"),s=V(),c=N("button"),a=Q("Put"),this.h()},l(_){e=M(_,"FORM",{});var u=R(e);t=M(u,"INPUT",{type:!0}),i=C(u),r=M(u,"TEXTAREA",{}),R(r).forEach(g),s=C(u),c=M(u,"BUTTON",{type:!0});var o=R(c);a=S(o,"Put"),o.forEach(g),u.forEach(g),this.h()},h(){ke(t,"type","text"),t.required=!0,ke(c,"type","submit"),c.disabled=l=n[2].isPending},m(_,u){y(_,e,u),P(e,t),z(t,n[0].key),P(e,i),P(e,r),z(r,n[0].value),P(e,s),P(e,c),P(c,a),f||(h=[w(t,"input",n[5]),w(r,"input",n[6]),w(e,"submit",we(n[7]))],f=!0)},p(_,[u]){u&1&&t.value!==_[0].key&&z(t,_[0].key),u&1&&z(r,_[0].value),u&4&&l!==(l=_[2].isPending)&&(c.disabled=l)},i:q,o:q,d(_){_&&g(e),f=!1,Re(h)}}}m(nt,"create_fragment$2");function rt(n,e,t){let i,r,s=q,c=m(()=>(s(),s=Qe(i,d=>t(2,r=d)),i),"$$subscribe_putMutation");n.$$.on_destroy.push(()=>s());let{KV:a}=e,{bindingName:l}=e;const f={key:"",value:""},h=ee();function _(){f.key=this.value,t(0,f),t(3,a),t(4,l)}m(_,"input_input_handler");function u(){f.value=this.value,t(0,f),t(3,a),t(4,l)}m(u,"textarea_input_handler");const o=m(()=>r.mutate(),"submit_handler");return n.$$set=d=>{"KV"in d&&t(3,a=d.KV),"bindingName"in d&&t(4,l=d.bindingName)},n.$$.update=()=>{n.$$.dirty&25&&c(t(1,i=re({mutationFn:()=>a.put(f.key,f.value),onSuccess:()=>{t(0,f.key="",f),t(0,f.value="",f),h.invalidateQueries({queryKey:["kv",l,"list"]})}})))},[f,i,r,a,l,_,u,o]}m(rt,"instance$2");const de=class de extends oe{constructor(e){super(),ce(this,e,rt,nt,ue,{KV:3,bindingName:4})}};m(de,"Add_key");let ae=de;function at(n){let e,t,i,r,s,c,a,l,f,h,_;return{c(){e=N("textarea"),t=V(),i=N("button"),r=Q("Put"),c=V(),a=N("button"),l=Q("Delete"),this.h()},l(u){e=M(u,"TEXTAREA",{}),R(e).forEach(g),t=C(u),i=M(u,"BUTTON",{});var o=R(i);r=S(o,"Put"),o.forEach(g),c=C(u),a=M(u,"BUTTON",{});var d=R(a);l=S(d,"Delete"),d.forEach(g),this.h()},h(){i.disabled=s=n[2].isPending,a.disabled=f=n[3].isPending},m(u,o){y(u,e,o),z(e,n[0]),y(u,t,o),y(u,i,o),P(i,r),y(u,c,o),y(u,a,o),P(a,l),h||(_=[w(e,"input",n[10]),w(i,"click",n[11]),w(a,"click",n[12])],h=!0)},p(u,o){o&1&&z(e,u[0]),o&4&&s!==(s=u[2].isPending)&&(i.disabled=s),o&8&&f!==(f=u[3].isPending)&&(a.disabled=f)},d(u){u&&(g(e),g(t),g(i),g(c),g(a)),h=!1,Re(_)}}}m(at,"create_if_block_2$1");function lt(n){let e,t,i=n[1].error.message+"",r;return{c(){e=N("pre"),t=Q("ðŸ’¥ "),r=Q(i)},l(s){e=M(s,"PRE",{});var c=R(e);t=S(c,"ðŸ’¥ "),r=S(c,i),c.forEach(g)},m(s,c){y(s,e,c),P(e,t),P(e,r)},p(s,c){c&2&&i!==(i=s[1].error.message+"")&&$(r,i)},d(s){s&&g(e)}}}m(lt,"create_if_block_1$1");function ut(n){let e;return{c(){e=Q("ðŸŒ€ Loading value...")},l(t){e=S(t,"ðŸŒ€ Loading value...")},m(t,i){y(t,e,i)},p:q,d(t){t&&g(e)}}}m(ut,"create_if_block$1");function ot(n){let e;function t(s,c){if(s[1].isLoading)return ut;if(s[1].isError)return lt;if(s[1].isSuccess)return at}m(t,"select_block_type");let i=t(n),r=i&&i(n);return{c(){r&&r.c(),e=D()},l(s){r&&r.l(s),e=D()},m(s,c){r&&r.m(s,c),y(s,e,c)},p(s,[c]){i===(i=t(s))&&r?r.p(s,c):(r&&r.d(1),r=i&&i(s),r&&(r.c(),r.m(e.parentNode,e)))},i:q,o:q,d(s){s&&g(e),r&&r.d(s)}}}m(ot,"create_fragment$1");function ct(n,e,t){let i,r,s,{KV:c}=e,{bindingName:a}=e,{key:l}=e;const f=Ge({queryKey:["kv",a,l.name],queryFn:()=>c.get(l.name)});W(n,f,E=>t(1,i=E));const h=ee(),_=re({mutationFn:()=>c.delete(l.name),onSuccess:()=>{h.invalidateQueries({queryKey:["kv",a]})}});W(n,_,E=>t(3,s=E));let u=null;const o=re({mutationFn:()=>c.put(l.name,String(u)),onSuccess:()=>{h.invalidateQueries({queryKey:["kv",a,l.name]})}});W(n,o,E=>t(2,r=E));function d(){u=this.value,t(0,u),t(1,i)}m(d,"textarea_input_handler");const p=m(()=>r.mutate(),"click_handler"),O=m(()=>s.mutate(),"click_handler_1");return n.$$set=E=>{"KV"in E&&t(7,c=E.KV),"bindingName"in E&&t(8,a=E.bindingName),"key"in E&&t(9,l=E.key)},n.$$.update=()=>{n.$$.dirty&3&&u===null&&i.data&&t(0,u=i.data)},[u,i,r,s,f,_,o,c,a,l,d,p,O]}m(ct,"instance$1");const _e=class _e extends oe{constructor(e){super(),ce(this,e,ct,ot,ue,{KV:7,bindingName:8,key:9})}};m(_e,"Kv_value");let le=_e;function Pe(n,e,t){const i=n.slice();return i[10]=e[t],i}m(Pe,"get_each_context");function Ne(n,e,t){const i=n.slice();return i[13]=e[t],i}m(Ne,"get_each_context_1");function ft(n){let e,t,i="<tr><th>Key</th> <th>Value</th></tr>",r,s,c,a,l,f=x(n[5].data.pages),h=[];for(let o=0;o<f.length;o+=1)h[o]=Ee(Pe(n,f,o));const _=m(o=>H(h[o],1,1,()=>{h[o]=null}),"out");let u=n[5].hasNextPage&&Oe(n);return{c(){e=N("table"),t=N("thead"),t.innerHTML=i,r=V(),s=N("tbody");for(let o=0;o<h.length;o+=1)h[o].c();c=V(),u&&u.c(),a=D()},l(o){e=M(o,"TABLE",{});var d=R(e);t=M(d,"THEAD",{"data-svelte-h":!0}),Ue(t)!=="svelte-o3ujz3"&&(t.innerHTML=i),r=C(d),s=M(d,"TBODY",{});var p=R(s);for(let O=0;O<h.length;O+=1)h[O].l(p);p.forEach(g),d.forEach(g),c=C(o),u&&u.l(o),a=D()},m(o,d){y(o,e,d),P(e,t),P(e,r),P(e,s);for(let p=0;p<h.length;p+=1)h[p]&&h[p].m(s,null);y(o,c,d),u&&u.m(o,d),y(o,a,d),l=!0},p(o,d){if(d&37){f=x(o[5].data.pages);let p;for(p=0;p<f.length;p+=1){const O=Pe(o,f,p);h[p]?(h[p].p(O,d),U(h[p],1)):(h[p]=Ee(O),h[p].c(),U(h[p],1),h[p].m(s,null))}for(he(),p=f.length;p<h.length;p+=1)_(p);fe()}o[5].hasNextPage?u?u.p(o,d):(u=Oe(o),u.c(),u.m(a.parentNode,a)):u&&(u.d(1),u=null)},i(o){if(!l){for(let d=0;d<f.length;d+=1)U(h[d]);l=!0}},o(o){h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)H(h[d]);l=!1},d(o){o&&(g(e),g(c),g(a)),De(h,o),u&&u.d(o)}}}m(ft,"create_if_block_2");function ht(n){let e,t,i=n[5].error.message+"",r;return{c(){e=N("pre"),t=Q("ðŸ’¥ "),r=Q(i)},l(s){e=M(s,"PRE",{});var c=R(e);t=S(c,"ðŸ’¥ "),r=S(c,i),c.forEach(g)},m(s,c){y(s,e,c),P(e,t),P(e,r)},p(s,c){c&32&&i!==(i=s[5].error.message+"")&&$(r,i)},i:q,o:q,d(s){s&&g(e)}}}m(ht,"create_if_block_1");function dt(n){let e;return{c(){e=Q("ðŸŒ€ Loading keys...")},l(t){e=S(t,"ðŸŒ€ Loading keys...")},m(t,i){y(t,e,i)},p:q,i:q,o:q,d(t){t&&g(e)}}}m(dt,"create_if_block");function Me(n,e){let t,i,r=e[13].name+"",s,c,a,l,f,h;return l=new le({props:{KV:e[0],bindingName:e[2],key:e[13]}}),{key:n,first:null,c(){t=N("tr"),i=N("td"),s=Q(r),c=V(),a=N("td"),Se(l.$$.fragment),f=V(),this.h()},l(_){t=M(_,"TR",{});var u=R(t);i=M(u,"TD",{});var o=R(i);s=S(o,r),o.forEach(g),c=C(u),a=M(u,"TD",{});var d=R(a);Ke(l.$$.fragment,d),d.forEach(g),f=C(u),u.forEach(g),this.h()},h(){this.first=t},m(_,u){y(_,t,u),P(t,i),P(i,s),P(t,c),P(t,a),Ve(l,a,null),P(t,f),h=!0},p(_,u){e=_,(!h||u&32)&&r!==(r=e[13].name+"")&&$(s,r);const o={};u&1&&(o.KV=e[0]),u&4&&(o.bindingName=e[2]),u&32&&(o.key=e[13]),l.$set(o)},i(_){h||(U(l.$$.fragment,_),h=!0)},o(_){H(l.$$.fragment,_),h=!1},d(_){_&&g(t),Ce(l)}}}m(Me,"create_each_block_1");function Ee(n){let e=[],t=new Map,i,r,s=x(n[10].keys);const c=m(a=>a[13].name,"get_key");for(let a=0;a<s.length;a+=1){let l=Ne(n,s,a),f=c(l);t.set(f,e[a]=Me(f,l))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();i=D()},l(a){for(let l=0;l<e.length;l+=1)e[l].l(a);i=D()},m(a,l){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(a,l);y(a,i,l),r=!0},p(a,l){l&37&&(s=x(a[10].keys),he(),e=He(e,l,c,1,a,s,t,i.parentNode,Ie,Me,i,Ne),fe())},i(a){if(!r){for(let l=0;l<s.length;l+=1)U(e[l]);r=!0}},o(a){for(let l=0;l<e.length;l+=1)H(e[l]);r=!1},d(a){a&&g(i);for(let l=0;l<e.length;l+=1)e[l].d(a)}}}m(Ee,"create_each_block");function Oe(n){let e,t,i,r,s;return{c(){e=N("button"),t=Q("Load more"),this.h()},l(c){e=M(c,"BUTTON",{});var a=R(e);t=S(a,"Load more"),a.forEach(g),this.h()},h(){e.disabled=i=n[5].isFetchingNextPage},m(c,a){y(c,e,a),P(e,t),r||(s=w(e,"click",n[8]),r=!0)},p(c,a){a&32&&i!==(i=c[5].isFetchingNextPage)&&(e.disabled=i)},d(c){c&&g(e),r=!1,s()}}}m(Oe,"create_if_block_3");function _t(n){let e,t=n[3].params.bindingName+"",i,r,s,c,a,l,f,h,_,u,o,d,p,O,E,me;f=new ae({props:{KV:n[0],bindingName:n[2]}});const pe=[dt,ht,ft],L=[];function ge(b,v){return b[5].isLoading?0:b[5].isError?1:b[5].isSuccess?2:-1}return m(ge,"select_block_type"),~(o=ge(n))&&(d=L[o]=pe[o](n)),{c(){e=Q("kv/"),i=Q(t),r=V(),s=N("button"),c=Q("Refresh"),l=V(),Se(f.$$.fragment),h=V(),_=N("hr"),u=V(),d&&d.c(),p=D(),this.h()},l(b){e=S(b,"kv/"),i=S(b,t),r=C(b),s=M(b,"BUTTON",{});var v=R(s);c=S(v,"Refresh"),v.forEach(g),l=C(b),Ke(f.$$.fragment,b),h=C(b),_=M(b,"HR",{}),u=C(b),d&&d.l(b),p=D(),this.h()},h(){s.disabled=a=n[5].isFetching},m(b,v){y(b,e,v),y(b,i,v),y(b,r,v),y(b,s,v),P(s,c),y(b,l,v),Ve(f,b,v),y(b,h,v),y(b,_,v),y(b,u,v),~o&&L[o].m(b,v),y(b,p,v),O=!0,E||(me=w(s,"click",n[7]),E=!0)},p(b,[v]){(!O||v&8)&&t!==(t=b[3].params.bindingName+"")&&$(i,t),(!O||v&32&&a!==(a=b[5].isFetching))&&(s.disabled=a);const te={};v&1&&(te.KV=b[0]),v&4&&(te.bindingName=b[2]),f.$set(te);let ie=o;o=ge(b),o===ie?~o&&L[o].p(b,v):(d&&(he(),H(L[ie],1,1,()=>{L[ie]=null}),fe()),~o?(d=L[o],d?d.p(b,v):(d=L[o]=pe[o](b),d.c()),U(d,1),d.m(p.parentNode,p)):d=null)},i(b){O||(U(f.$$.fragment,b),U(d),O=!0)},o(b){H(f.$$.fragment,b),H(d),O=!1},d(b){b&&(g(e),g(i),g(r),g(s),g(l),g(h),g(_),g(u),g(p)),Ce(f,b),~o&&L[o].d(b),E=!1,me()}}}m(_t,"create_fragment");function bt(n,e,t){let i,r,s,c,a,l,f=q,h=m(()=>(f(),f=Qe(c,p=>t(5,l=p)),c),"$$subscribe_listQuery");W(n,xe,p=>t(3,a=p)),n.$$.on_destroy.push(()=>f());const{bindings:_}=Be("appContext"),u=ee(),o=m(()=>u.invalidateQueries({queryKey:s}),"click_handler"),d=m(()=>l.fetchNextPage(),"click_handler_1");return n.$$.update=()=>{n.$$.dirty&8&&t(2,i=a.params.bindingName),n.$$.dirty&4&&t(0,r=_[i]),n.$$.dirty&4&&t(1,s=["kv",i,"list"]),n.$$.dirty&3&&h(t(4,c=it({queryKey:s,queryFn:({pageParam:p})=>r.list({cursor:p.cursor,limit:10}),initialPageParam:{cursor:null},getNextPageParam:p=>p.list_complete?void 0:p})))},[r,s,i,a,c,l,u,o,d]}m(bt,"instance");const be=class be extends oe{constructor(e){super(),ce(this,e,bt,_t,ue,{})}};m(be,"Page");let Te=be;export{Te as component};
